@tailwind base;
@tailwind components;
@tailwind utilities;

/* Optimizaciones globales para móvil */
* {
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
}

html {
  /* Prevenir zoom en inputs en iOS */
  -webkit-text-size-adjust: 100%;
  /* Scroll suave */
  scroll-behavior: smooth;
  /* Altura dinámica para móviles (considera barra de URL) */
  height: -webkit-fill-available;
}

body {
  margin: 0;
  padding: 0;
  font-family:
    'Inter',
    -apple-system,
    BlinkMacSystemFont,
    'Segoe UI',
    sans-serif;
  background-color: #313338;
  color: #dbdee1;
  overflow: hidden;
  /* Altura dinámica para móviles */
  min-height: 100vh;
  min-height: -webkit-fill-available;
  /* Prevenir overscroll bounce en iOS */
  overscroll-behavior: none;
  /* Mejorar rendimiento en móvil */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Tema: variables reutilizables para coherencia visual */
:root {
  --bg: #2f3136; /* Base app */
  --chat-bg: #232428; /* Chat input background */
  --sidebar-bg: #1f2023;
  --muted: #9aa0a6;
  --text: #e6e9ec;
  --blurple: #5865F2;
  --accent: rgba(88,101,242,0.12);
  --surface: #2b2d31;
  --glass: rgba(255,255,255,0.02);
  --shadow: 0 6px 18px rgba(0,0,0,0.6);
}

/* LockScreen color tokens to reuse in Impostor theme */
:root {
  --lock-bg: #ffcc17; /* main yellow background */
  --lock-accent: #ff4d0a; /* orange accent */
  --lock-accent-2: #ff9300; /* secondary orange */
  --lock-hover: #e03e00;
  --lock-shadow: #cc3300;
  --lock-text-dark: #2b2b2b;
}

/* Theme helper to apply lock-screen colours to game */
.impostor-theme {
  background: linear-gradient(180deg, var(--lock-bg), #ffd84d 80%);
  color: var(--lock-text-dark);
}
.impostor-theme .impostor-reveal-panel {
  background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,250,230,0.98));
  color: var(--lock-text-dark);
  border-color: rgba(0,0,0,0.06);
}
.impostor-theme .impostor-card-face {
  border-color: rgba(0,0,0,0.06);
}
.impostor-theme .btn-lock-accent {
  background: var(--lock-accent);
  color: white;
}
.impostor-theme .btn-lock-accent:hover { background: var(--lock-hover); }
.impostor-theme .avatar-accent { background: var(--lock-accent); color: white; }
.impostor-theme .avatar-initial { background: rgba(0,0,0,0.08); color: var(--lock-text-dark); }

/* Improved contrast tokens for Impostor UI */
:root {
  --impostor-surface: #fffdf6; /* light surface to contrast */
  --impostor-text: #0b0b0b; /* dark text for readability */
  --impostor-muted: #6b6b6b;
  --impostor-accent: var(--lock-accent);
}

/* Liquid glass styling (backdrop blur + sheen + subtle borders) */
.liquid-glass {
  background: linear-gradient(180deg, rgba(255,255,255,0.72), rgba(255,255,255,0.42));
  -webkit-backdrop-filter: blur(10px) saturate(140%) contrast(105%);
  backdrop-filter: blur(10px) saturate(140%) contrast(105%);
  border: 1px solid rgba(255,255,255,0.35);
  box-shadow: 0 8px 30px rgba(10,10,10,0.12), inset 0 1px 0 rgba(255,255,255,0.35);
  color: var(--impostor-text);
}

/* Sheen pseudo-element for liquid look */
.liquid-glass::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: linear-gradient(120deg, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0.06) 30%, rgba(255,255,255,0.02) 60%, rgba(255,255,255,0));
  pointer-events: none;
  mix-blend-mode: overlay;
}

/* Higher contrast for text and interactive elements inside theme */
.impostor-theme { color: var(--impostor-text); }
.impostor-theme .text-contrast { color: var(--impostor-text); }
.impostor-theme .muted-contrast { color: var(--impostor-muted); }
.impostor-theme .turn-item { color: var(--impostor-text); }

/* Adjust confetti palette to match lock accent and higher contrast */
.confetti span { box-shadow: 0 4px 10px rgba(0,0,0,0.12); }

/* Ensure responsive aside width with min/max */
@media (min-width: 880px) {
  .impostor-grid { grid-template-columns: 1fr 320px; }
}
@media (max-width: 879px) {
  .impostor-grid { grid-template-columns: 1fr; }
}

/* Layout helpers to avoid overlapping elements */
.app-shell {
  display: flex;
  height: 100dvh;
  min-height: 100vh;
  overflow: hidden;
}

.no-overlap {
  position: relative;
  z-index: 0;
}

/* Ensure inputs and modals sit above normal content but below global overlays */
.z-base { z-index: 10; }
.z-top { z-index: 40; }
.z-overlay { z-index: 90; }

/* Suggestion dropdown styling (positioned absolute relative to input container) */
.mention-suggestions {
  position: absolute;
  bottom: calc(100% + 8px);
  left: 0;
  width: 100%;
  max-width: 520px;
  background: var(--surface);
  border: 1px solid rgba(255,255,255,0.04);
  box-shadow: var(--shadow);
  border-radius: 10px;
  overflow: hidden;
  animation: slide-in-up 160ms ease-out;
}

@media (max-width: 768px) {
  .mention-suggestions {
    max-width: 100%;
    left: 0;
    right: 0;
    bottom: calc(100% + 6px);
    border-radius: 8px;
  }

  /* Ensure safe area padding for chat on mobile so inputs don't overlap content */
  .chat-input-safe { padding-bottom: 3.5rem; }
}

.mention-suggestions .item:hover {
  background: rgba(88,101,242,0.14);
}

/* Input container safe area so messages never hide under the input */
.chat-input-safe { padding-bottom: 1.25rem; }

/* Compact spacing adjustments */
:root {
  --compact-avatar: 36px;
  --compact-gap: 8px;
  --compact-padding: 8px;
}

/* Send button styling adjustments */
.message-send-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  border-radius: 8px;
}


#root {
  width: 100vw;
  width: 100dvw; /* Dynamic viewport width */
  height: 100vh;
  height: 100dvh; /* Dynamic viewport height */
  /* Prevenir selección accidental de texto en móvil */
  user-select: none;
  -webkit-user-select: none;
}

/* Permitir selección solo en inputs y áreas de texto */
input,
textarea,
[contenteditable] {
  user-select: text;
  -webkit-user-select: text;
}

/* Optimizar scrollbars para móvil */
@media (max-width: 768px) {
  ::-webkit-scrollbar {
    width: 4px;
    height: 4px;
  }

  /* Ocultar scrollbars en móvil pero mantener funcionalidad */
  .custom-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: transparent transparent;
  }

  .custom-scrollbar::-webkit-scrollbar {
    width: 2px;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: rgba(255, 255, 255, 0.1);
  }
}

/* Touch-friendly buttons */
@media (max-width: 768px) {
  button,
  a,
  [role='button'] {
    min-height: 44px; /* iOS touch target recomendado */
    min-width: 44px;
  }
}

/* Animaciones personalizadas */
@keyframes pulse-subtle {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.6;
  }
}

@keyframes slide-in-up {
  from {
    transform: translateY(10px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes glow {
  0%,
  100% {
    box-shadow: 0 0 5px rgba(88, 101, 242, 0.3);
  }
  50% {
    box-shadow: 0 0 20px rgba(88, 101, 242, 0.6);
  }
}

.animate-slide-in-up {
  animation: slide-in-up 0.2s ease-out;
}

.animate-pulse-subtle {
  animation: pulse-subtle 1.5s ease-in-out infinite;
}

.animate-glow {
  animation: glow 2s ease-in-out infinite;
}

/* Impostor game specific animations and visuals */
.impostor-card {
  perspective: 1200px;
}
.impostor-card-inner {
  width: 100%;
  transform-style: preserve-3d;
  transition: transform 700ms cubic-bezier(.2,.9,.2,1);
  position: relative;
}
.impostor-card.flipped .impostor-card-inner {
  transform: rotateY(180deg);
}
.impostor-card-face {
  backface-visibility: hidden;
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 12px;
}
.impostor-card-front {
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.18));
  transform: rotateY(0deg);
}
.impostor-card-back {
  transform: rotateY(180deg);
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(16,16,16,0.34));
}

/* Nice spinner / roulette feel */
.impostor-spinner {
  width: 96px;
  height: 96px;
  border-radius: 999px;
  border: 6px solid rgba(255,255,255,0.06);
  border-top-color: var(--blurple);
  animation: spin 900ms linear infinite;
}
@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Reveal overlay and confetti */
.impostor-reveal-overlay {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 120;
}
.impostor-reveal-panel {
  width: min(820px, 92%);
  padding: 2.25rem;
  border-radius: 16px;
  text-align: center;
  box-shadow: 0 18px 60px rgba(2,6,23,0.75);
  transform-origin: center;
  animation: reveal-pop 560ms cubic-bezier(.2,.9,.2,1);
}
@keyframes reveal-pop {
  0% { transform: scale(.92) translateY(8px); opacity: 0; }
  60% { transform: scale(1.04) translateY(-6px); opacity: 1; }
  100% { transform: scale(1) translateY(0); opacity: 1; }
}

/* Confetti simple implementation: multiple spans animated downwards */
.confetti { position: absolute; inset: 0; pointer-events: none; overflow: visible; }
.confetti span {
  position: absolute;
  width: 10px;
  height: 16px;
  opacity: 0.95;
  border-radius: 2px;
  transform-origin: center;
  animation: confetti-fall 1600ms linear forwards;
}
@keyframes confetti-fall {
  0% { transform: translateY(-20vh) rotate(0deg) scale(1); }
  70% { transform: translateY(40vh) rotate(360deg) scale(0.9); }
  100% { transform: translateY(60vh) rotate(720deg) scale(0.85); opacity: 0; }
}

/* Responsive layout tweaks for the impostor page */
.impostor-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1rem;
}
@media (min-width: 880px) {
  .impostor-grid { grid-template-columns: 2fr 360px; }
}

/* Turn order item animation */
.turn-item { transition: transform 260ms ease, box-shadow 260ms ease, background 260ms ease; }
.turn-item.active { transform: translateX(6px) scale(1.02); box-shadow: 0 8px 24px rgba(0,0,0,0.45); }
.turn-item.innocent { box-shadow: 0 6px 18px rgba(6,80,30,0.28); }

