import{v as u,$ as _,a as e,W as S,M as H,N as z,c as D,D as M,H as I,C as $,b as F,Y as Q,E as W,Q as Y,z as f,L as q,_ as J,s as K}from"./index-CB2GMSFj.js";const X=({socket:n})=>{const[b,l]=u.useState([]),[d,i]=u.useState(!1);return u.useEffect(()=>{if(!n||!n.connected)return;const j=o=>{const h=`[${new Date().toLocaleTimeString()}] ${o.message||o}`;l(v=>[...v.slice(-49),h])};return d||(n.emit("admin:subscribe-logs"),n.on("admin:log-entry",j),i(!0)),()=>{n&&d&&(n.emit("admin:unsubscribe-logs"),n.off("admin:log-entry",j),i(!1))}},[n,d]),e.jsxs("div",{className:"discord-glass-subtle p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 text-discord-text-header font-bold",children:[e.jsx($,{className:"text-purple-400",size:20}),e.jsx("h3",{children:"Logs del Backend en Tiempo Real"})]}),e.jsx("div",{className:"bg-black/50 rounded p-3 max-h-64 overflow-y-auto custom-scrollbar font-mono text-xs space-y-1",children:b.length===0?e.jsx("div",{className:"text-discord-text-muted text-center py-4",children:"Esperando logs del servidor..."}):b.map((j,o)=>e.jsx("div",{className:"text-discord-text-normal whitespace-pre-wrap break-words",children:j},o))}),e.jsxs("div",{className:"mt-2 text-xs text-discord-text-muted",children:["Mostrando los últimos ",b.length," logs • Estado: ",d?"Conectado":"Desconectado"]})]})},Z=({socket:n})=>{var b,l,d;const[i,j]=u.useState(null),[o,h]=u.useState(!0),[v,y]=u.useState(null);u.useEffect(()=>{fetch("https://api.mcsrvstat.us/2/mc.unaspartidillas.online").then(k=>k.json()).then(k=>{j(k),h(!1)}).catch(()=>h(!1));const p=Date.now();fetch(`${q()}/api/health`).then(()=>y(Date.now()-p)).catch(()=>y(-1))},[]);const w=(n==null?void 0:n.connected)??!1,g=(n==null?void 0:n.id)||"-",c=((d=(l=(b=n==null?void 0:n.io)==null?void 0:b.engine)==null?void 0:l.transport)==null?void 0:d.name)||"Unknown";return e.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"discord-glass-subtle p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 text-discord-text-header font-bold",children:[e.jsx(J,{className:"text-green-400",size:20}),e.jsx("h3",{children:"Servidor Minecraft"})]}),o?e.jsx("div",{className:"animate-pulse h-20 bg-discord-surface rounded"}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-discord-text-muted",children:"Estado"}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${i!=null&&i.online?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:i!=null&&i.online?"ONLINE":"OFFLINE"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-discord-text-muted",children:"IP"}),e.jsx("span",{className:"text-discord-text-normal font-mono text-sm",children:"mc.unaspartidillas.online"})]}),(i==null?void 0:i.online)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-discord-text-muted",children:"Jugadores"}),e.jsxs("span",{className:"text-discord-text-normal",children:[i.players.online," / ",i.players.max]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-discord-text-muted",children:"Versión"}),e.jsx("span",{className:"text-discord-text-normal text-xs",children:"1.20.4 - 1.21.10"})]})]})]})]}),e.jsxs("div",{className:"discord-glass-subtle p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 text-discord-text-header font-bold",children:[e.jsx(K,{className:"text-blue-400",size:20}),e.jsx("h3",{children:"Servidor Web & Socket"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-discord-text-muted",children:"Socket.IO"}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${w?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:w?"CONECTADO":"DESCONECTADO"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-discord-text-muted",children:"ID de Sesión"}),e.jsx("span",{className:"text-discord-text-normal font-mono text-xs truncate max-w-[150px]",children:g})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-discord-text-muted",children:"Latencia API"}),e.jsx("span",{className:`font-mono text-sm ${!v||v>500?"text-red-400":"text-green-400"}`,children:v?`${v}ms`:"Calculando..."})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-discord-text-muted",children:"Transporte"}),e.jsx("span",{className:"text-discord-text-normal text-xs uppercase",children:c})]})]})]})]}),e.jsx(X,{socket:n})]})},ee=u.memo(({isOpen:n,onClose:b,currentUser:l,socket:d})=>{const i=a=>{g({action:a,values:{}}),p({})},{users:j}=_(),[o,h]=u.useState(!1),[v,y]=u.useState(null),[w,g]=u.useState(null),[c,p]=u.useState({}),[k,B]=u.useState([]),[E,T]=u.useState(!1),O=u.useMemo(()=>j.filter(a=>!a.isBot&&a.id!==(l==null?void 0:l.id)),[j,l]);if(!n)return null;if(!d)return e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fadeIn",children:e.jsxs("div",{className:"discord-card max-w-md w-full p-8 border-red-600 flex flex-col items-center",children:[e.jsx(S,{className:"w-10 h-10 text-red-600 mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-red-600 mb-2",children:"Error de conexión"}),e.jsx("p",{className:"text-base text-discord-text-normal mb-4 text-center",children:"No se ha detectado conexión con el servidor."}),e.jsx("button",{onClick:b,className:"discord-button danger",children:"Cerrar"})]})});const A=async(a,s=!0)=>{if(s&&v!==a){y(a),setTimeout(()=>y(null),5e3);return}h(!0),y(null);try{const t=(r,m)=>new Promise(C=>{try{d==null||d.emit(r,m,R=>C(R)),setTimeout(()=>C(null),2e3)}catch{C({ok:!1,error:"emit_error"})}});let x=null;switch(a){case"clear-messages":{l&&(x=await t("admin:clear-all-messages",{adminId:l.id}));break}case"silence-user":{const r=c.userId||"";r&&l&&(x=await t("admin:silence-user",{userId:r,adminId:l.id})),g(null);break}case"change-color":{const r=c.userId||"",m=c.color||"";r&&m&&l&&(x=await t("admin:change-color",{userId:r,color:m,adminId:l.id})),g(null);break}case"global-message":{const r=c.message||"";if(r&&l){const m={content:r,adminId:l.id};(c.sendAsBot==="true"||c.sendAsBot===!0)&&(m.sendAsBot=!0,c.channelId&&(m.channelId=c.channelId)),x=await t("admin:global-message",m)}g(null);break}case"troll-mode":{const r=c.userId||"";if(r&&l){let m=c.mode||null;(m==="clear"||m==="")&&(m=null),x=await t("admin:troll-mode",{userId:r,mode:m,adminId:l.id})}g(null);break}case"reset-ips-cache":{l&&(x=await t("admin:reset-ips-cache",{adminId:l.id}));break}}x&&x.ok===!1?f.error(x.error||"Error ejecutando la acción"):f.success("Acción enviada con éxito")}catch{f.error("Error ejecutando la acción")}finally{setTimeout(()=>h(!1),1e3)}},L=async()=>{T(!0);try{const a=await((s,t)=>new Promise(x=>{try{d==null||d.emit(s,t,r=>x(r)),setTimeout(()=>x(null),2e3)}catch{x({ok:!1,error:"emit_error"})}}))("admin:get-active-rooms",{adminId:l==null?void 0:l.id});a&&a.ok?B(a.rooms||[]):f.error("Error al cargar salas activas")}catch{f.error("Error al cargar salas activas")}finally{T(!1)}},P=async(a,s)=>{h(!0);try{const t=await((x,r)=>new Promise(m=>{try{d==null||d.emit(x,r,C=>m(C)),setTimeout(()=>m(null),2e3)}catch{m({ok:!1,error:"emit_error"})}}))(`admin:${a}`,{adminId:l==null?void 0:l.id,roomId:s});t&&t.ok?(f.success(`Sala ${a==="delete-room"?"eliminada":"terminada"} exitosamente`),L()):f.error((t==null?void 0:t.error)||`Error al ${a==="delete-room"?"eliminar":"terminar"} la sala`)}catch{f.error(`Error al ${a==="delete-room"?"eliminar":"terminar"} la sala`)}finally{setTimeout(()=>h(!1),1e3)}},G=async a=>{h(!0);try{const s=await((t,x)=>new Promise(r=>{try{d==null||d.emit(t,x,m=>r(m)),setTimeout(()=>r(null),2e3)}catch{r({ok:!1,error:"emit_error"})}}))("admin:join-room-as-admin",{adminId:l==null?void 0:l.id,roomId:a});s&&s.ok?(f.success("Te has unido a la sala como observador"),g(null)):f.error((s==null?void 0:s.error)||"Error al unirte a la sala")}catch{f.error("Error al unirte a la sala")}finally{setTimeout(()=>h(!1),1e3)}},U=({value:a,onChange:s})=>e.jsxs("select",{value:a,onChange:t=>s(t.target.value),className:"w-full discord-input",children:[e.jsx("option",{value:"",children:"-- Seleccionar Usuario --"}),O.map(t=>e.jsxs("option",{value:t.id,children:[t.username," ",t.status==="offline"?"(Offline)":""]},t.id))]}),V=()=>{if(!w)return null;const{action:a}=w;return a==="system-status"?e.jsxs("div",{className:"discord-panel animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-discord-text-header flex items-center gap-2",children:[e.jsx($,{size:20}),"Estado del Sistema"]}),e.jsx("button",{onClick:()=>g(null),className:"discord-button secondary text-xs py-1 px-2",children:"Volver"})]}),e.jsx(Z,{socket:d})]}):a==="room-management"?e.jsxs("div",{className:"discord-panel animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-discord-text-header flex items-center gap-2",children:[e.jsx(S,{size:20}),"Gestión de Salas"]}),e.jsx("button",{onClick:()=>g(null),className:"discord-button secondary text-xs py-1 px-2",children:"Volver"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:L,className:"discord-button w-full",disabled:E,children:E?"Cargando...":"Actualizar Lista"}),E?e.jsx("div",{className:"text-center py-8 text-discord-text-muted animate-pulse",children:"Cargando salas activas..."}):k.length===0?e.jsx("div",{className:"text-center py-8 text-discord-text-muted",children:"No hay salas activas"}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:k.map(s=>e.jsxs("div",{className:"discord-glass-subtle p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-discord-text-header",children:s.name}),e.jsxs("p",{className:"text-sm text-discord-text-muted",children:["Host: ",s.hostName," • ",s.playerCount,"/10 jugadores"]}),e.jsxs("p",{className:"text-xs text-discord-text-normal",children:["Estado: ",s.started?"En juego":"Esperando"," •",s.hasPassword?"Privada":"Pública"]})]}),e.jsx("div",{className:`px-2 py-1 rounded text-xs font-bold ${s.started?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:s.started?"ACTIVA":"ESPERANDO"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>G(s.roomId),className:"flex-1 discord-button secondary text-xs py-2",disabled:o,children:[e.jsx(Q,{size:14,className:"inline mr-1"}),"Observar"]}),s.started&&e.jsxs("button",{onClick:()=>P("terminate-room",s.roomId),className:"flex-1 discord-button warning text-xs py-2",disabled:o,children:[e.jsx(W,{size:14,className:"inline mr-1"}),"Terminar"]}),e.jsxs("button",{onClick:()=>P("delete-room",s.roomId),className:"flex-1 discord-button danger text-xs py-2",disabled:o,children:[e.jsx(Y,{size:14,className:"inline mr-1"}),"Eliminar"]})]})]},s.roomId))})]})]}):e.jsxs("div",{className:"discord-panel animate-fadeIn",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 text-discord-text-header flex items-center gap-2",children:[a==="change-color"&&e.jsx(M,{size:20}),a==="global-message"&&e.jsx(z,{size:20}),a==="silence-user"&&e.jsx(D,{size:20}),a==="troll-mode"&&e.jsx(I,{size:20}),a==="trigger-effect"&&e.jsx(I,{size:20}),a==="change-color"?"Cambiar Color":a==="global-message"?"Mensaje Global":a==="silence-user"?"Silenciar Usuario":a==="troll-mode"?"Modo Troll":"Efecto Gracioso"]}),e.jsxs("div",{className:"space-y-4",children:[(a==="silence-user"||a==="change-color"||a==="troll-mode"||a==="trigger-effect")&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-discord-text-muted mb-1 block",children:"Usuario Objetivo"}),e.jsx(U,{value:c.userId||"",onChange:s=>p(t=>({...t,userId:s}))})]}),a==="change-color"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-discord-text-muted mb-1 block",children:"Color HEX"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",value:c.color||"#ffffff",onChange:s=>p(t=>({...t,color:s.target.value})),className:"h-10 w-14 bg-transparent cursor-pointer"}),e.jsx("input",{value:c.color||"",onChange:s=>p(t=>({...t,color:s.target.value})),className:"flex-1 discord-input",placeholder:"#RRGGBB"})]})]}),a==="global-message"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-discord-text-muted mb-1 block",children:"Mensaje"}),e.jsx("textarea",{value:c.message||"",onChange:s=>p(t=>({...t,message:s.target.value})),className:"w-full discord-input",rows:3,placeholder:"Escribe tu mensaje aquí..."}),e.jsx("div",{className:"flex items-center gap-3 mt-3",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.sendAsBot==="true",onChange:s=>p(t=>({...t,sendAsBot:s.target.checked?"true":"false"})),className:"rounded bg-discord-dark border-gray-600"}),e.jsx("span",{className:"text-discord-text-normal",children:"Enviar como Bot"})]})})]}),a==="troll-mode"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-discord-text-muted mb-1 block",children:"Tipo de Troll"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{id:"uwu",label:"UwUify",desc:"Convierte todo a UwU"},{id:"meow",label:"Meowify",desc:"Agrega maullidos"},{id:"kawaii",label:"Kawaii",desc:"Exceso de ternura"},{id:"",label:"Desactivar",desc:"Volver a la normalidad",danger:!0}].map(s=>e.jsxs("button",{onClick:()=>p(t=>({...t,mode:s.id})),className:`p-2 rounded border text-left transition-all ${c.mode===s.id?"bg-discord-blurple border-discord-blurple text-white":s.danger?"border-red-500/50 hover:bg-red-500/10 text-red-400":"border-discord-hover hover:bg-discord-hover text-discord-text-normal"}`,children:[e.jsx("div",{className:"font-bold text-sm",children:s.label}),e.jsx("div",{className:"text-xs opacity-70",children:s.desc})]},s.id))})]}),a==="trigger-effect"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-discord-text-muted mb-1 block",children:"Efecto"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{id:"rotate",label:"Rotar Pantalla",desc:"Gira la pantalla 180°"},{id:"confetti",label:"Confeti",desc:"Explosión de alegría"},{id:"jumpscare",label:"Susto (Suave)",desc:"Imagen rápida"},{id:"fart",label:"Sonido Gracioso",desc:"Sonido de pedo"}].map(s=>e.jsxs("button",{onClick:()=>p(t=>({...t,effect:s.id})),className:`p-2 rounded border text-left transition-all ${c.effect===s.id?"bg-discord-blurple border-discord-blurple text-white":"border-discord-hover hover:bg-discord-hover text-discord-text-normal"}`,children:[e.jsx("div",{className:"font-bold text-sm",children:s.label}),e.jsx("div",{className:"text-xs opacity-70",children:s.desc})]},s.id))})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4 border-t border-discord-border mt-2",children:[e.jsx("button",{onClick:()=>g(null),className:"discord-button secondary",children:"Cancelar"}),e.jsx("button",{onClick:()=>A(a,!1),className:"discord-button",children:"Aplicar"})]})]})]})};return e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fadeIn",onClick:b,children:e.jsxs("div",{className:"discord-card max-w-2xl w-full max-h-[90vh] overflow-hidden animate-scaleIn flex flex-col",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"bg-discord-blurple p-4 flex items-center justify-between shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{className:"w-6 h-6 text-white"}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"Panel de Administración"})]}),e.jsx("button",{onClick:b,className:"text-white hover:bg-white/20 rounded p-1 transition-colors","aria-label":"Cerrar",children:e.jsx(H,{size:24})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4 sm:p-6",children:w?V():e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(N,{icon:e.jsx(z,{size:24}),title:"Limpiar Chat",description:"Borrar todos los mensajes",onClick:()=>A("clear-messages"),isConfirming:v==="clear-messages",isLoading:o,variant:"danger"}),e.jsx(N,{icon:e.jsx(D,{size:24}),title:"Silenciar",description:"Mutear a un usuario",onClick:()=>i("silence-user"),isConfirming:!1,isLoading:o,variant:"warning"}),e.jsx(N,{icon:e.jsx(M,{size:24}),title:"Cambiar Color",description:"Personalizar nombre",onClick:()=>i("change-color"),isConfirming:!1,isLoading:o,variant:"info"}),e.jsx(N,{icon:e.jsx(z,{size:24}),title:"Anuncio Global",description:"Enviar mensaje a todos",onClick:()=>i("global-message"),isConfirming:!1,isLoading:o,variant:"success"}),e.jsx(N,{icon:e.jsx(I,{size:24}),title:"Modo Troll",description:"Modificar chat del usuario",onClick:()=>i("troll-mode"),isConfirming:!1,isLoading:o,variant:"warning"}),e.jsx(N,{icon:e.jsx(I,{size:24}),title:"Efecto Gracioso",description:"Rotar pantalla, sonidos...",onClick:()=>i("trigger-effect"),isConfirming:!1,isLoading:o,variant:"warning"}),e.jsx(N,{icon:e.jsx($,{size:24}),title:"Estado del Sistema",description:"Ver métricas del servidor",onClick:()=>i("system-status"),isConfirming:!1,isLoading:o,variant:"info"}),e.jsx(N,{icon:e.jsx(F,{size:24}),title:"Gestionar Salas",description:"Ver, unirte y eliminar salas activas",onClick:()=>i("room-management"),isConfirming:!1,isLoading:o,variant:"info"})]})}),e.jsx("div",{className:"bg-discord-dark p-3 border-t border-discord-border shrink-0",children:e.jsxs("p",{className:"text-xs text-discord-text-muted text-center",children:["Admin: ",l==null?void 0:l.username]})})]})})}),N=u.memo(({icon:n,title:b,description:l,onClick:d,isConfirming:i,isLoading:j,variant:o})=>{const h={danger:"bg-red-500/10 border-red-500/50 hover:bg-red-500/20 text-red-400",warning:"bg-yellow-500/10 border-yellow-500/50 hover:bg-yellow-500/20 text-yellow-400",info:"bg-blue-500/10 border-blue-500/50 hover:bg-blue-500/20 text-blue-400",success:"bg-green-500/10 border-green-500/50 hover:bg-green-500/20 text-green-400"};return e.jsxs("button",{onClick:d,disabled:j,className:`p-4 rounded-lg border transition-all flex flex-col items-center text-center gap-2 ${i?"bg-red-600 border-red-500 text-white animate-pulse":h[o]} ${j?"opacity-50 cursor-not-allowed":"hover:scale-[1.02]"}`,children:[e.jsx("div",{className:i?"text-white":"",children:n}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg",children:i?"¿Confirmar?":b}),e.jsx("p",{className:"text-xs opacity-80",children:i?"Clic para ejecutar":l})]})]})});N.displayName="ActionButton";ee.displayName="AdminPanel";export{ee as default};
